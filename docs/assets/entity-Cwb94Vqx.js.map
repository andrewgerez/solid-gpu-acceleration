{"version":3,"file":"entity-Cwb94Vqx.js","sources":["../../src/pages/entity.tsx"],"sourcesContent":["import {\r\n  ElementNode,\r\n  Text,\r\n  View,\r\n  Show,\r\n  assertTruthy,\r\n} from '@lightningtv/solid'\r\nimport { Column, Row } from '@lightningtv/solid/primitives'\r\n\r\nimport { createEffect, on, createSignal } from 'solid-js'\r\nimport { TileRow, Button } from '../components'\r\nimport { setGlobalBackground } from '../state'\r\nimport ContentBlock from '../components/content-block'\r\nimport { useNavigate } from '@solidjs/router'\r\nimport styles from '../styles'\r\n\r\nconst Entity = (props) => {\r\n  const [backdropAlpha, setBackdropAlpha] = createSignal(0)\r\n  const navigate = useNavigate()\r\n\r\n  createEffect(\r\n    on(\r\n      props.data.entity,\r\n      (data) => {\r\n        setGlobalBackground(data.backgroundImage)\r\n      },\r\n      { defer: true }\r\n    )\r\n  )\r\n\r\n  const columnY = 640\r\n\r\n  const Backdrop = {\r\n    color: '#000000',\r\n    alpha: 0,\r\n    width: 1900,\r\n    height: 890,\r\n    x: -160,\r\n    y: columnY,\r\n    borderRadius: 30,\r\n  }\r\n\r\n  function onRowFocus(this: ElementNode) {\r\n    this.children[this.selected || 0].setFocus()\r\n    columnRef.y = columnY\r\n    backdropRef.y = columnY\r\n    backdropRef.alpha = 0\r\n  }\r\n\r\n  function onRowFocusAnimate(this: ElementNode) {\r\n    this.children[this.selected || 0].setFocus()\r\n    columnRef.y = 200\r\n    backdropRef.y = 160\r\n    backdropRef.alpha = 0.9\r\n  }\r\n\r\n  function onEnter(this: ElementNode) {\r\n    let entity = this.children.find((c) => c.states.has('focus'))\r\n    assertTruthy(entity && entity.href)\r\n    navigate(entity.href as string)\r\n  }\r\n\r\n  function onEscape() {\r\n    document.getElementsByTagName('canvas')[0].focus()\r\n    entityActions.setFocus()\r\n    setBackdropAlpha(0)\r\n  }\r\n\r\n  function onEnterTrailer() {\r\n    setBackdropAlpha(0.9)\r\n  }\r\n\r\n  let columnRef, backdropRef, entityActions\r\n  \r\n  return (\r\n    <Show when={props.data.entity()}>\r\n      <View x={170} onUp={() => entityActions.setFocus()} onEscape={onEscape}>\r\n        <ContentBlock\r\n          y={260}\r\n          content={props.data.entity().heroContent}\r\n        ></ContentBlock>\r\n        <Row\r\n          ref={entityActions}\r\n          y={500}\r\n          scroll='none'\r\n          height={90}\r\n          width={640}\r\n          gap={40}\r\n          onDown={() => columnRef.setFocus()}\r\n          onEnter={onEnterTrailer}\r\n        >\r\n          <Button width={300} autofocus={props.data.entity()}>\r\n            Play\r\n          </Button>\r\n          <Button width={300}>Resume</Button>\r\n        </Row>\r\n\r\n        <Column\r\n          ref={columnRef}\r\n          x={0}\r\n          y={columnY}\r\n          style={styles.Column}\r\n          height={880}\r\n          scroll='none'\r\n          zIndex={5}\r\n        >\r\n          <Show when={props.data.recommendations() && props.data.credits()}>\r\n            <Text skipFocus style={styles.RowTitle}>\r\n              Recommendations\r\n            </Text>\r\n            <TileRow\r\n              onFocus={onRowFocus}\r\n              onEnter={onEnter}\r\n              items={props.data.recommendations()}\r\n              width={1620}\r\n            />\r\n            <Text skipFocus style={styles.RowTitle}>\r\n              Cast and Crew\r\n            </Text>\r\n            <TileRow\r\n              onFocus={onRowFocusAnimate}\r\n              onEnter={onEnter}\r\n              items={props.data.credits()}\r\n              width={1620}\r\n            />\r\n          </Show>\r\n        </Column>\r\n        <View\r\n          ref={backdropRef}\r\n          style={Backdrop}\r\n          transition={{ alpha: true, y: true }}\r\n        />\r\n      </View>\r\n      <View\r\n        alpha={backdropAlpha()}\r\n        color={'#000000'}\r\n        skipFocus\r\n        zIndex={200}\r\n        transition={{ alpha: true }}\r\n      />\r\n    </Show>\r\n  )\r\n}\r\n\r\nexport default Entity\r\n"],"names":["Entity","props","backdropAlpha","setBackdropAlpha","createSignal","navigate","useNavigate","createEffect","on","data","entity","setGlobalBackground","backgroundImage","defer","columnY","Backdrop","color","alpha","width","height","x","y","borderRadius","onRowFocus","children","selected","setFocus","columnRef","backdropRef","onRowFocusAnimate","onEnter","find","c","states","has","href","onEscape","document","getElementsByTagName","focus","entityActions","onEnterTrailer","_$createComponent","Show","when","View","onUp","ContentBlock","content","heroContent","Row","ref","r$","_ref$","scroll","gap","onDown","Button","autofocus","Column","_ref$2","style","styles","zIndex","_$memo","recommendations","credits","Text","skipFocus","RowTitle","TileRow","onFocus","items","_ref$3","transition"],"mappings":"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"}