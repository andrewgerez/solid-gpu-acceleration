{"version":3,"file":"entity-legacy-CDuwprmK.js","sources":["../../src/pages/entity.tsx"],"sourcesContent":["import {\r\n  ElementNode,\r\n  Text,\r\n  View,\r\n  Show,\r\n  assertTruthy,\r\n} from '@lightningtv/solid'\r\nimport { Column, Row } from '@lightningtv/solid/primitives'\r\n\r\nimport { createEffect, on, createSignal } from 'solid-js'\r\nimport { TileRow, Button } from '../components'\r\nimport { setGlobalBackground } from '../state'\r\nimport ContentBlock from '../components/content-block'\r\nimport { useNavigate } from '@solidjs/router'\r\nimport styles from '../styles'\r\n\r\nconst Entity = (props) => {\r\n  const [backdropAlpha, setBackdropAlpha] = createSignal(0)\r\n  const navigate = useNavigate()\r\n\r\n  createEffect(\r\n    on(\r\n      props.data.entity,\r\n      (data) => {\r\n        setGlobalBackground(data.backgroundImage)\r\n      },\r\n      { defer: true }\r\n    )\r\n  )\r\n\r\n  const columnY = 640\r\n\r\n  const Backdrop = {\r\n    color: '#000000',\r\n    alpha: 0,\r\n    width: 1900,\r\n    height: 890,\r\n    x: -160,\r\n    y: columnY,\r\n    borderRadius: 30,\r\n  }\r\n\r\n  function onRowFocus(this: ElementNode) {\r\n    this.children[this.selected || 0].setFocus()\r\n    columnRef.y = columnY\r\n    backdropRef.y = columnY\r\n    backdropRef.alpha = 0\r\n  }\r\n\r\n  function onRowFocusAnimate(this: ElementNode) {\r\n    this.children[this.selected || 0].setFocus()\r\n    columnRef.y = 200\r\n    backdropRef.y = 160\r\n    backdropRef.alpha = 0.9\r\n  }\r\n\r\n  function onEnter(this: ElementNode) {\r\n    let entity = this.children.find((c) => c.states.has('focus'))\r\n    assertTruthy(entity && entity.href)\r\n    navigate(entity.href as string)\r\n  }\r\n\r\n  function onEscape() {\r\n    document.getElementsByTagName('canvas')[0].focus()\r\n    entityActions.setFocus()\r\n    setBackdropAlpha(0)\r\n  }\r\n\r\n  function onEnterTrailer() {\r\n    setBackdropAlpha(0.9)\r\n  }\r\n\r\n  let columnRef, backdropRef, entityActions\r\n  \r\n  return (\r\n    <Show when={props.data.entity()}>\r\n      <View x={170} onUp={() => entityActions.setFocus()} onEscape={onEscape}>\r\n        <ContentBlock\r\n          y={260}\r\n          content={props.data.entity().heroContent}\r\n        ></ContentBlock>\r\n        <Row\r\n          ref={entityActions}\r\n          y={500}\r\n          scroll='none'\r\n          height={90}\r\n          width={640}\r\n          gap={40}\r\n          onDown={() => columnRef.setFocus()}\r\n          onEnter={onEnterTrailer}\r\n        >\r\n          <Button width={300} autofocus={props.data.entity()}>\r\n            Play\r\n          </Button>\r\n          <Button width={300}>Resume</Button>\r\n        </Row>\r\n\r\n        <Column\r\n          ref={columnRef}\r\n          x={0}\r\n          y={columnY}\r\n          style={styles.Column}\r\n          height={880}\r\n          scroll='none'\r\n          zIndex={5}\r\n        >\r\n          <Show when={props.data.recommendations() && props.data.credits()}>\r\n            <Text skipFocus style={styles.RowTitle}>\r\n              Recommendations\r\n            </Text>\r\n            <TileRow\r\n              onFocus={onRowFocus}\r\n              onEnter={onEnter}\r\n              items={props.data.recommendations()}\r\n              width={1620}\r\n            />\r\n            <Text skipFocus style={styles.RowTitle}>\r\n              Cast and Crew\r\n            </Text>\r\n            <TileRow\r\n              onFocus={onRowFocusAnimate}\r\n              onEnter={onEnter}\r\n              items={props.data.credits()}\r\n              width={1620}\r\n            />\r\n          </Show>\r\n        </Column>\r\n        <View\r\n          ref={backdropRef}\r\n          style={Backdrop}\r\n          transition={{ alpha: true, y: true }}\r\n        />\r\n      </View>\r\n      <View\r\n        alpha={backdropAlpha()}\r\n        color={'#000000'}\r\n        skipFocus\r\n        zIndex={200}\r\n        transition={{ alpha: true }}\r\n      />\r\n    </Show>\r\n  )\r\n}\r\n\r\nexport default Entity\r\n"],"names":["Entity","props","_createSignal","createSignal","_createSignal2","_slicedToArray","backdropAlpha","setBackdropAlpha","navigate","useNavigate","createEffect","on","data","entity","setGlobalBackground","backgroundImage","defer","columnY","Backdrop","color","alpha","width","height","x","y","borderRadius","onRowFocus","children","selected","setFocus","columnRef","backdropRef","onRowFocusAnimate","onEnter","find","c","states","has","href","onEscape","document","getElementsByTagName","focus","entityActions","onEnterTrailer","_$createComponent","Show","when","View","onUp","ContentBlock","content","heroContent","Row","ref","r$","_ref$","scroll","gap","onDown","Button","autofocus","Column","_ref$2","style","styles","zIndex","_$memo","recommendations","credits","Text","skipFocus","RowTitle","TileRow","onFocus","items","_ref$3","transition"],"mappings":"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"}